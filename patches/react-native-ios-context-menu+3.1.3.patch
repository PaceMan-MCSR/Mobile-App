diff --git a/node_modules/react-native-ios-context-menu/react-native-ios-context-menu.podspec b/node_modules/react-native-ios-context-menu/react-native-ios-context-menu.podspec
index abc123d..def456e 100644
--- a/node_modules/react-native-ios-context-menu/react-native-ios-context-menu.podspec
+++ b/node_modules/react-native-ios-context-menu/react-native-ios-context-menu.podspec
@@ -30,7 +30,11 @@ fabric_enabled = ENV['RCT_NEW_ARCH_ENABLED'] == '1'
 folly_version = '2022.05.16.00'
 folly_compiler_flags = get_folly_config()[:compiler_flags]
 
+base_flags = "-DREACT_NATIVE_TARGET_VERSION=#{reactNativeTargetVersion}"
+
 linkage = ENV['USE_FRAMEWORKS']
+
+use_rn_dep = ENV['RCT_USE_RN_DEP'] == '1'
 reactNativeTargetVersionOverride = ENV['REACT_NATIVE_TARGET_VERSION']
 
 puts "react-native-ios-context-menu"
@@ -47,7 +51,11 @@ if reactNativeTargetVersionOverride
 end
 
 fabric_compiler_flags = '-DRN_FABRIC_ENABLED -DRCT_NEW_ARCH_ENABLED'
-compiler_flags = folly_compiler_flags + ' ' + "-DREACT_NATIVE_TARGET_VERSION=#{reactNativeTargetVersion}"
+if use_rn_dep
+  compiler_flags = base_flags
+else
+  compiler_flags = [folly_compiler_flags, base_flags].reject(&:empty?).join(' ')
+end
 
 if use_hermes
   compiler_flags << ' -DUSE_HERMES'
@@ -157,7 +165,9 @@ Pod::Spec.new do |s|
 
   if fabric_enabled
     s.dependency 'React-RCTFabric'
-    s.dependency 'RCT-Folly', folly_version
+    unless use_rn_dep
+      s.dependency 'RCT-Folly', folly_version
+    end
   end
 
   s.dependency 'react-native-ios-utilities'
